{
    "Agents_Config": [
        {
            "ID":1,
            "model":"iris",
            "mode": "real",
            "marker_color": [255,0,0,0.5],
            "ual_use": false,
            "agent_manager_on_gs": false,
            "ssh_params": {
                "hostname":"safedrone2",
                "username":"safedrone2"
            }
        },
        {
            "ID":2,
            "model":"iris",
            "mode": "sitl",
            "marker_color": [0,255,0,0.5],
            "ual_use": true,
            "agent_manager_on_gs": true,
            "ssh_params": {
                "hostname":"safedrone4",
                "username":"safedrone4"
            }
        },        {
            "ID":3,
            "model":"iris",
            "mode": "sitl",
            "marker_color": [0,0,255,0.5],
            "ual_use": true,
            "agent_manager_on_gs": true,
            "ssh_params": {
                "hostname":"safedrone3",
                "username":"safedrone3"
            }
        }
    ],
    "State_Machine": [
        {
            "type": "CBState",
            "state_type":"world_config",
            "name": "new world",
            "parameters" : {
                "action" : "spawn",
                "id" : 1
            },
            "outcomes": {
                "completed": "add world"
            }
        },
        {
            "type": "CBState",
            "state_type":"world_config",
            "name": "add world",
            "parameters" : {
                "action" : "add",
                "world_part_def" : "from_hyperparameters"
            },
            
            "outcomes": {
                "completed": "world_created_wait"
            }
        },
        {
            "type": "CBState",
            "state_type":"wait",
            "name": "world_created_wait",
            "parameters": {
                "exit_type": "time",
                "duration": 0.01
            },
            "outcomes": {
                "completed": "spawn_Agents"
            }
        },
        {
            "type": "CBState",
            "state_type":"spawn_agents",
            "name": "spawn_Agents",
            "parameters": {
                "initial_poses": [["Flights","Take_off_1","matrix",[0,0,0]],
                                  ["Flights","Take_off_2","matrix",[0,0,0]],
                                  ["Flights","Take_off_3","matrix",[0,0,0]]]
            },
            "outcomes": {
                "completed": "unifly_wait"
            }
        }        ,
        {
            "type": "CBState",
            "state_type":"wait",
            "name": "unifly_wait",
            "parameters": {
                "exit_type": "external_input",
                "external_input" : "unifly_ready"
            },
            "outcomes": {
                "completed": "allocate_areas"
            }
        },
        {
            "type": "CBState",
            "state_type":"execute_script",
            "name": "allocate_areas",
            "parameters": {
                "path": "/home/joseandresmr/catkin_ws/src/magna/Code/scripts/Various/SafedroneInverseNode.py"
            },
            "outcomes": {
                "completed": "add_unifly_world"
            }
        },
        {
            "type": "CBState",
            "state_type":"world_config",
            "name": "add_unifly_world",
            "parameters" : {
                "action" : "add",
                "world_part_def" : [{ "name" : "JSON", "world" : "Safedrone", "subworld" : "volumes_from_unifly"}]
            },
            
            "outcomes": {
                "completed": "1_set_mission"
            }
        },
        {
            "type": "Concurrence",
            "name": "set_mission",
            "ids": 1,
            "occurrencies": [
                {
                    "type": "SimpleActionState",
                    "state_type": "set_mission",
                    "name": "set_mission",
                    "ids": 1,
                    "ids_var": "agent",
                    "parameters": {
                        "path": [
                            {
                                "definition":["Flights","Take_off_1","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                            },
                            {
                                "definition":["PolygonsFromUnifly","Polygon_1","path","Zigzag"]
                            },
                            {
                                "definition":["Flights","Take_off_1","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                            }
                        ]
                    },
                    "outcomes":{
                        "succeeded": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "utm_new_flightplan" : "completed",
                        "low_battery": "completed",
                        "preempted": "collision",
                        "aborted": "collision"
                    }
                },
                {
                    "type": "SimpleActionState",
                    "state_type": "set_mission",
                    "name": "set_mission",
                    "ids": 2,
                    "ids_var": "agent",
                    "parameters": {
                        "path": [
                            {
                                "definition":["Flights","Take_off_2","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                            },
                            {
                                "definition":["PolygonsFromUnifly","Polygon_2","path","Zigzag"]
                            },
                            {
                                "definition":["Flights","Take_off_2","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                            }
                        ]
                    },
                    "outcomes":{
                        "succeeded": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "utm_new_flightplan" : "completed",
                        "low_battery": "completed",
                        "preempted": "collision",
                        "aborted": "collision"
                    }
                },
                {
                    "type": "SimpleActionState",
                    "state_type": "set_mission",
                    "name": "set_mission",
                    "ids": 3,
                    "ids_var": "agent",
                    "parameters": {
                        "path": [
                            {
                                "definition":["Flights","Take_off_3","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                            },
                            {
                                "definition":["PolygonsFromUnifly","Polygon_3","path","Zigzag"]
                            },
                            {
                                "definition":["Flights","Take_off_3","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                            }
                        ]
                    },
                    "outcomes":{
                        "succeeded": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "utm_new_flightplan" : "completed",
                        "low_battery": "completed",
                        "preempted": "collision",
                        "aborted": "collision"
                    }
                }
            ],
            "occurrencies_outcome_map": {
                "completed": {
                    "all": "completed"
                },
                "aborted": {
                    "all": "collision"
                }
            },
            "outcomes": {
                "completed": "algorithm_control_global"
            }
        },
        {
            "type": "CBState",
            "state_type":"algorithm_control",
            "name": "algorithm_control_global",
            "ids": "all",
            "ids_var" : "agent",
            "parameters": {
                "name": "global",
                "action": "set",
                "params": ["N_neighbors_aware"],
                "values": [0]
            },
            "outcomes": {
                "completed": "algorithm_control_simple"
            }
        },
        {
            "type": "CBState",
            "state_type":"algorithm_control",
            "name": "algorithm_control_simple",
            "ids": "all",
            "ids_var" : "agent",
            "parameters": {
                "name": "simple",
                "action": "set",
                "params": ["N_neighbors_aware"],
                "values": [0]
            },
            "outcomes": {
                "completed": "1_take_off"
            }
        },
        {
            "type": "Concurrence",
            "name": "take_off",
            "ids": 1,
            "occurrencies": [
                {
                    "type": "StateMachine",
                    "name": "take_off",
                    "ids": 1,
                    "occurrencies": [
                        {
                            "type": "CBState",
                            "state_type":"wait",
                            "name": "initial_wait",
                            "parameters": {
                                "exit_type": "external_input",
                                "external_input" : "1_take_off"
                            },
                            "outcomes": {
                                "completed": "1_take_off",
                                "failed": "collision"
                            }
                        },
                        {
                            "type": "SimpleActionState",
                            "state_type": "take_off",
                            "name": "take_off",
                            "ids": 1,
                            "ids_var": "agent",
                            "parameters": {
                                "height": 5
                            },
                            "outcomes":{
                                "succeeded": "completed",
                                "collision": "collision",
                                "GS_critical_event": "GS_critical_event",
                                "utm_new_flightplan" : "completed",
                                "low_battery": "completed",
                                "preempted": "collision",
                                "aborted": "collision"
                            }
                        }
                    ],
                    "outcomes":{
                        "completed": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "low_battery": "low_battery"
                    }
                },
                {
                    "type": "StateMachine",
                    "name": "take_off",
                    "ids": 2,
                    "occurrencies": [
                        {
                            "type": "CBState",
                            "state_type":"wait",
                            "name": "initial_wait",
                            "parameters": {
                                "exit_type": "external_input",
                                "external_input" : "2_take_off"
                            },
                            "outcomes": {
                                "completed": "2_take_off",
                                "failed": "collision"
                            }
                        },
                        {
                            "type": "SimpleActionState",
                            "state_type": "take_off",
                            "name": "take_off",
                            "ids": 2,
                            "ids_var": "agent",
                            "parameters": {
                                "height": 5
                            },
                            "outcomes":{
                                "succeeded": "completed",
                                "collision": "collision",
                                "GS_critical_event": "GS_critical_event",
                                "utm_new_flightplan" : "completed",
                                "low_battery": "completed",
                                "preempted": "collision",
                                "aborted": "collision"
                            }
                        }
                    ],
                    "outcomes":{
                        "completed": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "low_battery": "low_battery"
                    }
                },
                {
                    "type": "StateMachine",
                    "name": "take_off",
                    "ids": 3,
                    "occurrencies": [
                        {
                            "type": "CBState",
                            "state_type":"wait",
                            "name": "initial_wait",
                            "parameters": {
                                "exit_type": "external_input",
                                "external_input" : "3_take_off"
                            },
                            "outcomes": {
                                "completed": "3_take_off",
                                "failed": "collision"
                            }
                        },
                        {
                            "type": "SimpleActionState",
                            "state_type": "take_off",
                            "name": "take_off",
                            "ids": 3,
                            "ids_var": "agent",
                            "parameters": {
                                "height": 5
                            },
                            "outcomes":{
                                "succeeded": "completed",
                                "collision": "collision",
                                "GS_critical_event": "GS_critical_event",
                                "utm_new_flightplan" : "completed",
                                "low_battery": "completed",
                                "preempted": "collision",
                                "aborted": "collision"
                            }
                        }
                    ],
                    "outcomes":{
                        "completed": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "low_battery": "low_battery"
                    }
                }
            ],
            "occurrencies_outcome_map": {
                "completed": {
                    "all": "completed"
                },
                "aborted": {
                    "all": "collision"
                }
            },
            "outcomes": {
                "completed": "after_takeoff_wait"
            }
        },
        {
            "type": "CBState",
            "state_type":"wait",
            "name": "after_takeoff_wait",
            "parameters": {
                "exit_type": "external_input",
                "external_input" : "start_mission"
            },
            "outcomes": {
                "completed": "1_area_sweep"
            }
        },
        {
            "type": "Concurrence",
            "name": "area_sweep",
            "ids": 1,
            "occurrencies": [
                {
                    "type": "StateMachine",
                    "name": "area_sweep",
                    "ids": 1,
                    "occurrencies": [
                        {
                            "type": "CBState",
                            "state_type":"wait",
                            "name": "initial_wait",
                            "parameters": {
                                "exit_type": "time",
                                "duration" : 0.5
                            },
                            "outcomes": {
                                "completed": "1_area_sweep",
                                "failed": "1_area_sweep"
                            }
                        },
                        {
                            "type": "SimpleActionState",
                            "state_type": "follow_path",
                            "name": "area_sweep",
                            "ids": 1,
                            "ids_var": "agent",
                            "parameters": {
                                "path": [
                                    {
                                        "definition":["Flights","Take_off_1","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                                    },
                                    {
                                        "definition":["PolygonsFromUnifly","Polygon_1","path","Zigzag"]
                                    },
                                    {
                                        "definition":["Flights","Take_off_1","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                                    }
                                ],
                                "smooth_path_mode": 0,
                                "dynamic" : "velocity"
                            },
                            "outcomes":{
                                "succeeded": "completed",
                                "collision": "collision",
                                "GS_critical_event": "GS_critical_event",
                                "utm_new_flightplan" : "completed",
                                "low_battery": "completed",
                                "preempted": "collision",
                                "aborted": "collision"
                            }
                        }
                    ],
                    "outcomes":{
                        "completed": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "low_battery": "low_battery"
                    }
                },
                {
                    "type": "StateMachine",
                    "name": "area_sweep",
                    "ids": 2,
                    "occurrencies": [
                        {
                            "type": "CBState",
                            "state_type":"wait",
                            "name": "initial_wait",
                            "parameters": {
                                "exit_type": "time",
                                "duration" : 0.5
                            },
                            "outcomes": {
                                "completed": "2_area_sweep",
                                "failed": "2_area_sweep"
                            }
                        },
                        {
                            "type": "SimpleActionState",
                            "state_type": "follow_path",
                            "name": "area_sweep",
                            "ids": 2,
                            "ids_var": "agent",
                            "parameters": {
                                "path": [
                                    {
                                        "definition":["Flights","Take_off_2","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                                    },
                                    {
                                        "definition":["PolygonsFromUnifly","Polygon_2","path","Zigzag"]
                                    },
                                    {
                                        "definition":["Flights","Take_off_2","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                                    }
                                ],
                                "smooth_path_mode": 0,
                                "dynamic": "velocity"
                            },
                            "outcomes":{
                                "succeeded": "completed",
                                "collision": "collision",
                                "GS_critical_event": "GS_critical_event",
                                "utm_new_flightplan" : "completed",
                                "low_battery": "completed",
                                "preempted": "collision",
                                "aborted": "collision"
                            }
                        }
                    ],
                    "outcomes":{
                        "completed": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "low_battery": "low_battery"
                    }
                },
                {
                    "type": "StateMachine",
                    "name": "area_sweep",
                    "ids": 3,
                    "occurrencies": [
                        {
                            "type": "CBState",
                            "state_type":"wait",
                            "name": "initial_wait",
                            "parameters": {
                                "exit_type": "time",
                                "duration" : 0.5
                            },
                            "outcomes": {
                                "completed": "3_area_sweep",
                                "failed": "3_area_sweep"
                            }
                        },
                        {
                            "type": "SimpleActionState",
                            "state_type": "follow_path",
                            "name": "area_sweep",
                            "ids": 3,
                            "ids_var": "agent",
                            "parameters": {
                                "path": [
                                    {
                                        "definition":["Flights","Take_off_3","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                                    },
                                    {
                                        "definition":["PolygonsFromUnifly","Polygon_3","path","Zigzag"]
                                    },
                                    {
                                        "definition":["Flights","Take_off_3","coordinates",[[0.0,0.0,7.0],[0,0,0,1]]]
                                    }
                                ],
                                "smooth_path_mode": 0,
                                "dynamic": "velocity"
                            },
                            "outcomes":{
                                "succeeded": "completed",
                                "collision": "collision",
                                "GS_critical_event": "GS_critical_event",
                                "utm_new_flightplan" : "completed",
                                "low_battery": "completed",
                                "preempted": "collision",
                                "aborted": "collision"
                            }
                        }
                    ],
                    "outcomes":{
                        "completed": "completed",
                        "collision": "collision",
                        "GS_critical_event": "GS_critical_event",
                        "low_battery": "low_battery"
                    }
                }
            ],
            "outcome_cb":"collision_if_any_collided",
            "occurrencies_outcome_map": {
                "completed": {
                    "all": "completed"
                },
                "collision": {
                    "all": "collision"
                },
                "low_battery": {
                    "all": "low_battery"
                },
                "GS_critical_event": {
                    "all": "GS_critical_event"
                }
            },
            "outcomes": {
                "completed": "1_save_csv",
                "collision": "1_hovering",
                "low_battery": "1_hovering",
                "GS_critical_event": "1_hovering"
            }
        },
        {
            "type": "Concurrence",
            "name": "hovering",
            "ids": 1,
            "occurrencies": [
                {
                    "type": "SimpleActionState",
                    "state_type": "basic_move",
                    "name": "hover",
                    "ids": 1,
                    "ids_var": "agent",
                    "parameters": {
                        "move_type": "translation",
                        "dynamic": "position",
                        "direction": "left",
                        "value": 0.0,
                        "duration": 1.0
                    }
                },
                {
                    "type": "SimpleActionState",
                    "state_type": "basic_move",
                    "name": "hover",
                    "ids": 2,
                    "ids_var": "agent",
                    "parameters": {
                        "move_type": "translation",
                        "dynamic": "position",
                        "direction": "left",
                        "value": 0.0,
                        "duration": 1.0
                    }
                }
            ],
            "occurrencies_outcome_map": {
                "completed": {
                    "all": "succeeded"
                },
                "collision": {
                    "all": "collision"
                },
                "low_battery": {
                    "all": "low_battery"
                }
            },
            "outcomes": {
                "completed": "safety_wait",
                "collision": "safety_wait",
                "low_battery": "safety_wait"
            }
        },
        {
            "type": "CBState",
            "state_type":"wait",
            "name": "safety_wait",
            "parameters": {
                "exit_type": "time",
                "duration": 10
            },
            "outcomes": {
                "completed": "1_save_csv"
            }
        },
        {
            "type": "Concurrence",
            "name": "save_csv",
            "ids": 1,
            "occurrencies": [
                {
                    "type": "CBState",
                    "state_type":"save_csv",
                    "name": "save_csv",
                    "ids": "all",
                    "ids_var" : "agent",
                    "outcomes": {
                        "completed": "succeded"
                    }
                }
            ],
            "occurrencies_outcome_map": {
                "completed": {
                    "save_csv": "succeeded"
                },
                "failed": {
                    "save_csv": "aborted"
                }
            },
            "outcomes": {
                "completed": "1_all_land"
            }
        },
        {
            "type": "Concurrence",
            "name": "all_land",
            "ids": 1,
            "occurrencies": [
                {
                    "type": "SimpleActionState",
                    "state_type": "land",
                    "name": "land",
                    "ids": "all",
                    "ids_var": "agent",
                    "parameters": {
                        "height": 2
                    }
                }
            ],
            "occurrencies_outcome_map": {
                "completed": {
                    "all": "succeeded"
                },
                "failed": {
                    "all": "aborted"
                }
            },
            "outcomes": {
                "completed": "delete_world"
            }
        },
        {
            "type": "CBState",
            "state_type":"world_config",
            "name": "delete_world",
            "parameters" : {
                "action" : "delete",
                "id" : 1
            },
            "outcomes": {
                "completed": "completed"
            }
        }
    ]
}